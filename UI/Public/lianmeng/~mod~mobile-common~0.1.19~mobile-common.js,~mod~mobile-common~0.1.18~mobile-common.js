define("mobile-common@0.1.19/js/geo",["./weixin","./util","cookie@~0.1.0"],function(o,e,n){function i(o,e){_hip.push(["mv",{module:s.MODULE,note:o,action:e||s.BROWSE}])}function t(o,e){for(var n=0,i=o.length;i>n;n++)o.shift().apply(this,e||[])}var c=o("./weixin"),a=o("./util"),r=o("cookie"),l="locallat",u="locallng",s={MODULE:"Home_Html5_Geolocation",FETCH:"getlocation",AGREE:"agreelocation",REJECT:"refuselocation",FAIL:"fail",SAME_CITY:"identicalcity",DIFFERENT_CITY:"changecity",CHANGE_CITY:"agreechangecity",NOT_CHANGE_CITY:"refusechangecity",CLICK:"click",BROWSE:"browse"},d=function(o,e){var n={expires:.25/24,path:"/"};r(l,o,n),r(u,e,n)},f=[],g=[],m=!1,p=function(o,e,n){if(o&&f.push(o),e&&g.push(e),!m){m=!0;var p=function(o){var e=o.coords.latitude,n=o.coords.longitude;d(e,n),t(f,[{lat:e,lng:n}]),m=!1},C=function(o){if(o&&o.code)switch(o.code){case 1:i(s.REJECT,s.CLICK);break;case 2:case 3:i(s.AGREE,s.CLICK),i(s.FAIL)}t(g),m=!1},v=r(l),h=r(u);if(v&&h)return void p({coords:{latitude:v,longitude:h}});if(c.isInWeixin()&&n&&n.addrSign)return void c.invoke("geoLocation",n,function(o){"geo_location:ok"==o.err_msg?p({coords:{latitude:o.latitude,longitude:o.longitude}}):C()});a.supportGeo()||C(),i(s.FETCH),navigator.geolocation.getCurrentPosition(function(o){i(s.AGREE,s.CLICK),p(o)},C,{enableHighAccuracy:!0,maximumAge:3e4,timeout:1e4})}};p.tag=i,p.CONSTANTS=s,n.exports=p},{}),define("mobile-common@0.1.19/js/locate",["cookie@~0.1.0","zepto-wepp@~1.1.0","./geo"],function(o,e,n){var i=o("cookie"),t=o("zepto-wepp"),c=o("./geo"),a=-1!=location.href.indexOf("51ping.com")?".51ping.com":".dianping.com",r=function(o){return{expires:o||.25/24,path:"/",domain:a}},l=function(){i("visitflag",1,r(365))};n.exports=function(o,e,n){function a(o,e){c(function(n){var i=n.lat,c=n.lng,a=-1!=location.href.indexOf("51ping.com")?"m.51ping.com":"m.dianping.com";t.ajax({url:"http://"+a+"/getlocalcityid",data:{lat:i,lng:c},dataType:"jsonp",success:function(n){200===n.code?o(n.message):e()},error:function(){e()}})},e,n)}function u(){if(!i("switchcityflashtoast")){var o=t("#J_toast");o.removeClass("Hide"),setTimeout(function(){o.addClass("Hide")},3e3),i("switchcityflashtoast","1",r(365))}}var s=i("cityid")||o,d=function(o,n,t){!i("noswitchcity")&&s&&o&&o!=s&&n&&t?(c.tag(c.CONSTANTS.DIFFERENT_CITY),confirm("您目前定位是在:"+n+",是否切换?")?setTimeout(function(){c.tag(c.CONSTANTS.CHANGE_CITY,c.CONSTANTS.CLICK),document.location.href=e?e(o,t,n):"/"+t},200):(i("noswitchcity","1",r()),c.tag(c.CONSTANTS.NOT_CHANGE_CITY,c.CONSTANTS.CLICK))):c.tag(c.CONSTANTS.SAME_CITY)},f=function(){var o=-1!=location.href.indexOf("51ping.com")?"m.51ping.com":"m.dianping.com";_hip.push(["mv",{module:"Home_Call_MapcenterService_All",action:"browse"}]),t.ajax({url:"http://"+o+"/ajax/getLocationInfo",data:{},dataType:"jsonp",success:function(o){if(200===o.code){_hip.push(["mv",{module:"Home_Call_MapcenterService_Success",action:"browse"}]);var e=o.message,n=e.cityId,i=e.cityName,t=e.cityPinyin;l(),d(n,i,t)}404===o.code&&u()},error:function(){u()}})},g=function(o){var e=o.cityid,n=o.citypinyin,i=o.cityname;d(e,i,n)},m=function(){f()};a(g,m)}},{}),define("mobile-common@0.1.19/js/lazyload",[],function(o,e,n){function i(o,e){return o.getAttribute(e)}function t(o){return o.filter(function(o){return!!i(o,c)})}var c="lazy-src",a=function(o){var e=t(o.get()),n=function(){e.forEach(function(o){var e=o.getBoundingClientRect().top,n=i(o,c);n&&e&&e<window.innerHeight&&(o.setAttribute("src",n),o.removeAttribute(c))}),e=t(e),e.length<=0&&window.removeEventListener("scroll",n,!1)};window.addEventListener("load",n,!1),window.addEventListener("scroll",n,!1),n()};n.exports=a},{}),define("mobile-common@0.1.19/js/util",[],function(o,e){e.extend=function(o,e){if(e){for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return o}},e.supportLocalStorage=function(){var o=window.localStorage&&null!=window.localStorage,e="local_test";if(o)try{localStorage.setItem(e,1),localStorage.removeItem(e)}catch(n){return!1}return o},e.supportGeo=function(){return!!navigator.geolocation},e.tpl=function(o,e){return o.replace(/{([^{}]*)}/g,function(o,n){return n in e?e[n]:""})}},{}),define("mobile-common@0.1.19/js/weixin",[],function(o,e){e.invoke=function(){function o(){WeixinJSBridge.invoke.apply(WeixinJSBridge,e)}var e=Array.prototype.slice.call(arguments,0);window.WeixinJSBridge?o():document.addEventListener("WeixinJSBridgeReady",o,!1)},e.isInWeixin=function(){return/MicroMessenger/.test(navigator.userAgent)}},{}),define("mobile-common@0.1.19/index",["./js/geo","./js/locate","./js/lazyload","./js/util"],function(o,e){e.Geo=o("./js/geo"),e.Locate=o("./js/locate"),e.LazyLoad=o("./js/lazyload"),e.Util=o("./js/util")},{main:!0});

define("mobile-common@0.1.18/js/geo",["./weixin","./util","cookie@~0.1.0"],function(o,e,n){function i(o,e){_hip.push(["mv",{module:s.MODULE,note:o,action:e||s.BROWSE}])}function t(o,e){for(var n=0;n<o.length;n++)o.shift().apply(this,e||[])}var c=o("./weixin"),a=o("./util"),r=o("cookie"),l="locallat",u="locallng",s={MODULE:"Home_Html5_Geolocation",FETCH:"getlocation",AGREE:"agreelocation",REJECT:"refuselocation",FAIL:"fail",SAME_CITY:"identicalcity",DIFFERENT_CITY:"changecity",CHANGE_CITY:"agreechangecity",NOT_CHANGE_CITY:"refusechangecity",CLICK:"click",BROWSE:"browse"},d=function(o,e){var n={expires:.25/24,path:"/"};r(l,o,n),r(u,e,n)},f=[],g=[],m=!1,p=function(o,e,n){if(o&&f.push(o),e&&g.push(e),!m){m=!0;var p=function(o){var e=o.coords.latitude,n=o.coords.longitude;d(e,n),t(f,[{lat:e,lng:n}]),m=!1},C=function(o){if(o&&o.code)switch(o.code){case 1:i(s.REJECT,s.CLICK);break;case 2:case 3:i(s.AGREE,s.CLICK),i(s.FAIL)}t(g),m=!1},v=r(l),h=r(u);if(v&&h)return void p({coords:{latitude:v,longitude:h}});if(c.isInWeixin()&&n&&n.addrSign)return void c.invoke("geoLocation",n,function(o){"geo_location:ok"==o.err_msg?p({coords:{latitude:o.latitude,longitude:o.longitude}}):C()});a.supportGeo()||C(),i(s.FETCH),navigator.geolocation.getCurrentPosition(function(o){i(s.AGREE,s.CLICK),p(o)},C,{enableHighAccuracy:!0,maximumAge:3e4,timeout:1e4})}};p.tag=i,p.CONSTANTS=s,n.exports=p},{}),define("mobile-common@0.1.18/js/locate",["cookie@~0.1.0","zepto-wepp@~1.1.0","./geo"],function(o,e,n){var i=o("cookie"),t=o("zepto-wepp"),c=o("./geo"),a=-1!=location.href.indexOf("51ping.com")?".51ping.com":".dianping.com",r=function(o){return{expires:o||.25/24,path:"/",domain:a}},l=function(){i("visitflag",1,r(365))};n.exports=function(o,e,n){function a(o,e){c(function(n){var i=n.lat,c=n.lng,a=-1!=location.href.indexOf("51ping.com")?"m.51ping.com":"m.dianping.com";t.ajax({url:"http://"+a+"/getlocalcityid",data:{lat:i,lng:c},dataType:"jsonp",success:function(n){200===n.code?o(n.message):e()},error:function(){e()}})},e,n)}function u(){if(!i("switchcityflashtoast")){var o=t("#J_toast");o.removeClass("Hide"),setTimeout(function(){o.addClass("Hide")},3e3),i("switchcityflashtoast","1",r(365))}}var s=i("cityid")||o,d=function(o,n,t){!i("noswitchcity")&&s&&o&&o!=s&&n&&t?(c.tag(c.CONSTANTS.DIFFERENT_CITY),confirm("您目前定位是在:"+n+",是否切换?")?setTimeout(function(){c.tag(c.CONSTANTS.CHANGE_CITY,c.CONSTANTS.CLICK),document.location.href=e?e(o,t,n):"/"+t},200):(i("noswitchcity","1",r()),c.tag(c.CONSTANTS.NOT_CHANGE_CITY,c.CONSTANTS.CLICK))):c.tag(c.CONSTANTS.SAME_CITY)},f=function(){var o=-1!=location.href.indexOf("51ping.com")?"m.51ping.com":"m.dianping.com";_hip.push(["mv",{module:"Home_Call_MapcenterService_All",action:"browse"}]),t.ajax({url:"http://"+o+"/ajax/getLocationInfo",data:{},dataType:"jsonp",success:function(o){if(200===o.code){_hip.push(["mv",{module:"Home_Call_MapcenterService_Success",action:"browse"}]);var e=o.message,n=e.cityId,i=e.cityName,t=e.cityPinyin;l(),d(n,i,t)}404===o.code&&u()},error:function(){u()}})},g=function(o){var e=o.cityid,n=o.citypinyin,i=o.cityname;d(e,i,n)},m=function(){f()};a(g,m)}},{}),define("mobile-common@0.1.18/js/lazyload",[],function(o,e,n){function i(o,e){return o.getAttribute(e)}function t(o){return o.filter(function(o){return!!i(o,c)})}var c="lazy-src",a=function(o){var e=t(o.get()),n=function(){e.forEach(function(o){var e=o.getBoundingClientRect().top,n=i(o,c);n&&e&&e<window.innerHeight&&(o.setAttribute("src",n),o.removeAttribute(c))}),e=t(e),e.length<=0&&window.removeEventListener("scroll",n,!1)};window.addEventListener("load",n,!1),window.addEventListener("scroll",n,!1),n()};n.exports=a},{}),define("mobile-common@0.1.18/js/util",[],function(o,e){e.extend=function(o,e){if(e){for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return o}},e.supportLocalStorage=function(){var o=window.localStorage&&null!=window.localStorage,e="local_test";if(o)try{localStorage.setItem(e,1),localStorage.removeItem(e)}catch(n){return!1}return o},e.supportGeo=function(){return!!navigator.geolocation},e.tpl=function(o,e){return o.replace(/{([^{}]*)}/g,function(o,n){return n in e?e[n]:""})}},{}),define("mobile-common@0.1.18/js/weixin",[],function(o,e){e.invoke=function(){function o(){WeixinJSBridge.invoke.apply(WeixinJSBridge,e)}var e=Array.prototype.slice.call(arguments,0);window.WeixinJSBridge?o():document.addEventListener("WeixinJSBridgeReady",o,!1)},e.isInWeixin=function(){return/MicroMessenger/.test(navigator.userAgent)}},{}),define("mobile-common@0.1.18/index",["./js/geo","./js/locate","./js/lazyload","./js/util"],function(o,e){e.Geo=o("./js/geo"),e.Locate=o("./js/locate"),e.LazyLoad=o("./js/lazyload"),e.Util=o("./js/util")},{main:!0});